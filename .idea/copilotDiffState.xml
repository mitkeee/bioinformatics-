<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/generate_detailed_reports.py">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/generate_detailed_reports.py" />
              <option name="originalContent" value="#!/usr/bin/env python3&#10;&quot;&quot;&quot;&#10;Generate Detailed Reports for Each Protein&#10;Creates formatted tables with all parameters for each PDB file&#10;&quot;&quot;&quot;&#10;&#10;import pandas as pd&#10;from pathlib import Path&#10;&#10;def generate_detailed_report(pdb_id, results_dir=&quot;results&quot;):&#10;    &quot;&quot;&quot;Generate a detailed formatted report for a single protein.&quot;&quot;&quot;&#10;&#10;    # Read the results CSV&#10;    csv_file = Path(results_dir) / f&quot;{pdb_id}_results.csv&quot;&#10;    if not csv_file.exists():&#10;        print(f&quot;⚠️  File not found: {csv_file}&quot;)&#10;        return None&#10;&#10;    df = pd.read_csv(csv_file)&#10;&#10;    # Create output file&#10;    output_file = Path(results_dir) / f&quot;{pdb_id}_detailed_report.txt&quot;&#10;&#10;    with open(output_file, 'w') as f:&#10;        # Header&#10;        f.write(&quot;=&quot; * 120 + &quot;\n&quot;)&#10;        f.write(f&quot;PROTEIN BURIAL ANALYSIS - DETAILED REPORT\n&quot;)&#10;        f.write(f&quot;PDB ID: {pdb_id.upper()}\n&quot;)&#10;        f.write(&quot;=&quot; * 120 + &quot;\n\n&quot;)&#10;&#10;        # Summary statistics&#10;        f.write(&quot;SUMMARY STATISTICS\n&quot;)&#10;        f.write(&quot;-&quot; * 120 + &quot;\n&quot;)&#10;        f.write(f&quot;Total Residues: {len(df)}\n\n&quot;)&#10;&#10;        # DSSP statistics&#10;        if df['dssp_class'].notna().sum() &gt; 0:&#10;            dssp_exterior = df['dssp_class'].sum()&#10;            dssp_interior = len(df[df['dssp_class'].notna()]) - dssp_exterior&#10;            f.write(f&quot;DSSP Classification:\n&quot;)&#10;            f.write(f&quot;  - Exterior (1): {int(dssp_exterior)} residues\n&quot;)&#10;            f.write(f&quot;  - Interior (0): {int(dssp_interior)} residues\n\n&quot;)&#10;&#10;        # Our method statistics&#10;        ncps_exterior = df['ncps_class'].sum()&#10;        ncps_interior = len(df) - ncps_exterior&#10;        f.write(f&quot;NCPS Classification (Our Method):\n&quot;)&#10;        f.write(f&quot;  - Exterior (1): {int(ncps_exterior)} residues\n&quot;)&#10;        f.write(f&quot;  - Interior (0): {int(ncps_interior)} residues\n\n&quot;)&#10;&#10;        # Agreement with DSSP&#10;        if df['dssp_class'].notna().sum() &gt; 0:&#10;            agreement = (df['dssp_class'] == df['ncps_class']).sum()&#10;            total_with_dssp = df['dssp_class'].notna().sum()&#10;            accuracy = (agreement / total_with_dssp) * 100&#10;            f.write(f&quot;Agreement with DSSP: {accuracy:.1f}% ({agreement}/{total_with_dssp})\n\n&quot;)&#10;&#10;        # Neighbor count statistics&#10;        f.write(f&quot;Neighbor Count Statistics:\n&quot;)&#10;        f.write(f&quot;  - 6Å Sphere: Mean={df['ncps_sphere_6'].mean():.1f}, &quot;&#10;                f&quot;Median={df['ncps_sphere_6'].median():.0f}, &quot;&#10;                f&quot;Range=[{df['ncps_sphere_6'].min():.0f}-{df['ncps_sphere_6'].max():.0f}]\n&quot;)&#10;        f.write(f&quot;  - 10Å Sphere: Mean={df['ncps_sphere_10'].mean():.1f}, &quot;&#10;                f&quot;Median={df['ncps_sphere_10'].median():.0f}, &quot;&#10;                f&quot;Range=[{df['ncps_sphere_10'].min():.0f}-{df['ncps_sphere_10'].max():.0f}]\n\n&quot;)&#10;&#10;        # Uniformity statistics&#10;        f.write(f&quot;Uniformity Statistics:\n&quot;)&#10;        f.write(f&quot;  - 6Å Sphere: Mean={df['ncps_sphere_6_uni'].mean():.2f}, &quot;&#10;                f&quot;Median={df['ncps_sphere_6_uni'].median():.2f}, &quot;&#10;                f&quot;Range=[{df['ncps_sphere_6_uni'].min():.2f}-{df['ncps_sphere_6_uni'].max():.2f}]\n&quot;)&#10;        f.write(f&quot;  - 10Å Sphere: Mean={df['ncps_sphere_10_uni'].mean():.2f}, &quot;&#10;                f&quot;Median={df['ncps_sphere_10_uni'].median():.2f}, &quot;&#10;                f&quot;Range=[{df['ncps_sphere_10_uni'].min():.2f}-{df['ncps_sphere_10_uni'].max():.2f}]\n\n&quot;)&#10;&#10;        f.write(&quot;=&quot; * 120 + &quot;\n\n&quot;)&#10;&#10;        # Main data table&#10;        f.write(&quot;DETAILED RESIDUE DATA\n&quot;)&#10;        f.write(&quot;=&quot; * 120 + &quot;\n\n&quot;)&#10;&#10;        # Column headers&#10;        f.write(f&quot;{'Res':&gt;4} {'ID':&gt;4} {'Num':&gt;5} | {'DSSP':&gt;8} {'DSSP':&gt;6} {'DSSP':&gt;4} | &quot;&#10;                f&quot;{'STRIDE':&gt;8} {'STRIDE':&gt;6} {'STRIDE':&gt;4} | &quot;&#10;                f&quot;{'NC6':&gt;4} {'Uni6':&gt;6} {'NC10':&gt;5} {'Uni10':&gt;6} | {'NCPS':&gt;5}\n&quot;)&#10;        f.write(f&quot;{'#':&gt;4} {'':&gt;4} {'':&gt;5} | {'ASA':&gt;8} {'Class':&gt;6} {'SS':&gt;4} | &quot;&#10;                f&quot;{'ASA':&gt;8} {'Class':&gt;6} {'SS':&gt;4} | &quot;&#10;                f&quot;{'':&gt;4} {'':&gt;6} {'':&gt;5} {'':&gt;6} | {'Class':&gt;5}\n&quot;)&#10;        f.write(&quot;-&quot; * 120 + &quot;\n&quot;)&#10;&#10;        # Data rows&#10;        for idx, row in df.iterrows():&#10;            # Format values&#10;            res_idx = idx + 1&#10;            res_id = row['res_id'][:3] if pd.notna(row['res_id']) else '---'&#10;            res_num = int(row['res_num']) if pd.notna(row['res_num']) else 0&#10;&#10;            dssp_asa = f&quot;{row['dssp_asa']:.1f}&quot; if pd.notna(row['dssp_asa']) else '---'&#10;            dssp_class = f&quot;{int(row['dssp_class'])}&quot; if pd.notna(row['dssp_class']) else '-'&#10;            dssp_ss = row['dssp_ss'] if pd.notna(row['dssp_ss']) and row['dssp_ss'] != '' else '-'&#10;&#10;            stride_asa = f&quot;{row['stride_asa']:.1f}&quot; if pd.notna(row['stride_asa']) else '---'&#10;            stride_class = f&quot;{int(row['stride_class'])}&quot; if pd.notna(row['stride_class']) else '-'&#10;            stride_ss = row['stride_ss'] if pd.notna(row['stride_ss']) and row['stride_ss'] != '' else '-'&#10;&#10;            nc6 = int(row['ncps_sphere_6']) if pd.notna(row['ncps_sphere_6']) else 0&#10;            uni6 = f&quot;{row['ncps_sphere_6_uni']:.3f}&quot; if pd.notna(row['ncps_sphere_6_uni']) else '---'&#10;            nc10 = int(row['ncps_sphere_10']) if pd.notna(row['ncps_sphere_10']) else 0&#10;            uni10 = f&quot;{row['ncps_sphere_10_uni']:.3f}&quot; if pd.notna(row['ncps_sphere_10_uni']) else '---'&#10;&#10;            ncps_class = int(row['ncps_class']) if pd.notna(row['ncps_class']) else 0&#10;&#10;            # Write row&#10;            f.write(f&quot;{res_idx:&gt;4} {res_id:&gt;4} {res_num:&gt;5} | &quot;&#10;                   f&quot;{dssp_asa:&gt;8} {dssp_class:&gt;6} {dssp_ss:&gt;4} | &quot;&#10;                   f&quot;{stride_asa:&gt;8} {stride_class:&gt;6} {stride_ss:&gt;4} | &quot;&#10;                   f&quot;{nc6:&gt;4} {uni6:&gt;6} {nc10:&gt;5} {uni10:&gt;6} | {ncps_class:&gt;5}\n&quot;)&#10;&#10;        f.write(&quot;=&quot; * 120 + &quot;\n\n&quot;)&#10;&#10;        # Legend&#10;        f.write(&quot;LEGEND:\n&quot;)&#10;        f.write(&quot;-&quot; * 120 + &quot;\n&quot;)&#10;        f.write(&quot;Res #     : Sequential residue number\n&quot;)&#10;        f.write(&quot;ID        : Residue amino acid code (ALA, GLN, etc.)\n&quot;)&#10;        f.write(&quot;Num       : Residue number from PDB file\n&quot;)&#10;        f.write(&quot;DSSP ASA  : DSSP accessible surface area (Ų)\n&quot;)&#10;        f.write(&quot;DSSP Class: DSSP classification (1=exterior ≥30Ų, 0=interior &lt;30Ų)\n&quot;)&#10;        f.write(&quot;DSSP SS   : DSSP secondary structure (H=helix, E=strand, C=coil, etc.)\n&quot;)&#10;        f.write(&quot;STRIDE ASA: STRIDE accessible surface area (Ų)\n&quot;)&#10;        f.write(&quot;STRIDE Class: STRIDE classification (1=exterior ≥24Ų, 0=interior &lt;24Ų)\n&quot;)&#10;        f.write(&quot;STRIDE SS : STRIDE secondary structure\n&quot;)&#10;        f.write(&quot;NC6       : Neighbor count within 6Å sphere\n&quot;)&#10;        f.write(&quot;Uni6      : Uniformity at 6Å (spherical variance, 0-1)\n&quot;)&#10;        f.write(&quot;NC10      : Neighbor count within 10Å sphere\n&quot;)&#10;        f.write(&quot;Uni10     : Uniformity at 10Å (spherical variance, 0-1)\n&quot;)&#10;        f.write(&quot;NCPS Class: Our classification (1=exterior, 0=interior)\n\n&quot;)&#10;&#10;        f.write(&quot;CLASSIFICATION PARAMETERS:\n&quot;)&#10;        f.write(&quot;  - nc6_threshold = 6 (minimum neighbors at 6Å)\n&quot;)&#10;        f.write(&quot;  - nc10_threshold = 12 (minimum neighbors at 10Å)\n&quot;)&#10;        f.write(&quot;  - uni6_threshold = 0.30 (minimum uniformity at 6Å)\n&quot;)&#10;        f.write(&quot;  - uni10_threshold = 0.60 (minimum uniformity at 10Å)\n&quot;)&#10;        f.write(&quot;  - Exterior if: NC6 &lt; 6 OR NC10 &lt; 12 OR Uni6 &lt; 0.30 OR Uni10 &lt; 0.60\n&quot;)&#10;        f.write(&quot;  - Interior otherwise\n\n&quot;)&#10;&#10;        f.write(&quot;=&quot; * 120 + &quot;\n&quot;)&#10;&#10;    return output_file&#10;&#10;def main():&#10;    &quot;&quot;&quot;Generate detailed reports for all proteins.&quot;&quot;&quot;&#10;&#10;    pdb_ids = ['3PTE', '4d05', '6wti', '7upo']&#10;&#10;    print(&quot;=&quot; * 80)&#10;    print(&quot;GENERATING DETAILED REPORTS FOR ALL PROTEINS&quot;)&#10;    print(&quot;=&quot; * 80)&#10;    print()&#10;&#10;    generated_files = []&#10;&#10;    for pdb_id in pdb_ids:&#10;        print(f&quot;Processing {pdb_id}...&quot;)&#10;        output_file = generate_detailed_report(pdb_id)&#10;&#10;        if output_file:&#10;            print(f&quot;  ✅ Generated: {output_file}&quot;)&#10;            generated_files.append(output_file)&#10;        else:&#10;            print(f&quot;  ❌ Failed to generate report&quot;)&#10;&#10;    print()&#10;    print(&quot;=&quot; * 80)&#10;    print(f&quot;✅ COMPLETE! Generated {len(generated_files)} detailed reports&quot;)&#10;    print(&quot;=&quot; * 80)&#10;    print()&#10;    print(&quot;Output files:&quot;)&#10;    for f in generated_files:&#10;        print(f&quot;  - {f}&quot;)&#10;    print()&#10;&#10;if __name__ == &quot;__main__&quot;:&#10;    main()&#10;&#10;" />
              <option name="updatedContent" value="#!/usr/bin/env python3&#10;&quot;&quot;&quot;&#10;Generate Detailed Reports for Each Protein&#10;Creates formatted tables with all parameters for each PDB file&#10;Includes complete confusion matrices and agreement/disagreement lists&#10;&quot;&quot;&quot;&#10;&#10;import pandas as pd&#10;import numpy as np&#10;from pathlib import Path&#10;from sklearn.metrics import confusion_matrix, accuracy_score, precision_score, recall_score, f1_score&#10;&#10;def generate_detailed_report(pdb_id, results_dir=&quot;results&quot;):&#10;    &quot;&quot;&quot;Generate a detailed formatted report for a single protein.&quot;&quot;&quot;&#10;&#10;    # Read the results CSV&#10;    csv_file = Path(results_dir) / f&quot;{pdb_id}_results.csv&quot;&#10;    if not csv_file.exists():&#10;        print(f&quot;⚠️  File not found: {csv_file}&quot;)&#10;        return None&#10;&#10;    df = pd.read_csv(csv_file)&#10;&#10;    # Create output file&#10;    output_file = Path(results_dir) / f&quot;{pdb_id}_detailed_report.txt&quot;&#10;&#10;    with open(output_file, 'w') as f:&#10;        # Header&#10;        f.write(&quot;=&quot; * 120 + &quot;\n&quot;)&#10;        f.write(f&quot;PROTEIN BURIAL ANALYSIS - DETAILED REPORT\n&quot;)&#10;        f.write(f&quot;PDB ID: {pdb_id.upper()}\n&quot;)&#10;        f.write(&quot;=&quot; * 120 + &quot;\n\n&quot;)&#10;&#10;        # Summary statistics&#10;        f.write(&quot;SUMMARY STATISTICS\n&quot;)&#10;        f.write(&quot;-&quot; * 120 + &quot;\n&quot;)&#10;        f.write(f&quot;Total Residues: {len(df)}\n\n&quot;)&#10;&#10;        # DSSP statistics&#10;        if df['dssp_class'].notna().sum() &gt; 0:&#10;            dssp_exterior = int(df['dssp_class'].sum())&#10;            dssp_interior = int(len(df[df['dssp_class'].notna()]) - dssp_exterior)&#10;            f.write(f&quot;DSSP Classification:\n&quot;)&#10;            f.write(f&quot;  - Exterior (1): {dssp_exterior} residues\n&quot;)&#10;            f.write(f&quot;  - Interior (0): {dssp_interior} residues\n&quot;)&#10;            f.write(f&quot;  - DSSP Cutoff Value: ASA ≥ 25% (relative accessible surface area)\n&quot;)&#10;            f.write(f&quot;    (If ASA ≥ 25%, classified as Exterior=1; otherwise Interior=0)\n\n&quot;)&#10;        &#10;        # STRIDE statistics&#10;        if df['stride_class'].notna().sum() &gt; 0:&#10;            stride_exterior = int(df['stride_class'].sum())&#10;            stride_interior = int(len(df[df['stride_class'].notna()]) - stride_exterior)&#10;            f.write(f&quot;STRIDE Classification:\n&quot;)&#10;            f.write(f&quot;  - Exterior (1): {stride_exterior} residues\n&quot;)&#10;            f.write(f&quot;  - Interior (0): {stride_interior} residues\n&quot;)&#10;            f.write(f&quot;  - STRIDE Cutoff Value: ASA ≥ 20% (relative accessible surface area)\n&quot;)&#10;            f.write(f&quot;    (If ASA ≥ 20%, classified as Exterior=1; otherwise Interior=0)\n\n&quot;)&#10;&#10;        # Our method statistics&#10;        ncps_exterior = int(df['ncps_class'].sum())&#10;        ncps_interior = int(len(df) - ncps_exterior)&#10;        f.write(f&quot;NCPS Classification (Our Method):\n&quot;)&#10;        f.write(f&quot;  - Exterior (1): {ncps_exterior} residues\n&quot;)&#10;        f.write(f&quot;  - Interior (0): {ncps_interior} residues\n\n&quot;)&#10;&#10;        # Agreement with DSSP&#10;        if df['dssp_class'].notna().sum() &gt; 0:&#10;            df_dssp = df[df['dssp_class'].notna()].copy()&#10;            agreement_dssp = (df_dssp['dssp_class'] == df_dssp['ncps_class']).sum()&#10;            total_with_dssp = len(df_dssp)&#10;            accuracy_dssp = (agreement_dssp / total_with_dssp) * 100&#10;            f.write(f&quot;Agreement with DSSP: {accuracy_dssp:.1f}% ({agreement_dssp}/{total_with_dssp})\n&quot;)&#10;        &#10;        # Agreement with STRIDE&#10;        if df['stride_class'].notna().sum() &gt; 0:&#10;            df_stride = df[df['stride_class'].notna()].copy()&#10;            agreement_stride = (df_stride['stride_class'] == df_stride['ncps_class']).sum()&#10;            total_with_stride = len(df_stride)&#10;            accuracy_stride = (agreement_stride / total_with_stride) * 100&#10;            f.write(f&quot;Agreement with STRIDE: {accuracy_stride:.1f}% ({agreement_stride}/{total_with_stride})\n\n&quot;)&#10;        else:&#10;            f.write(&quot;\n&quot;)&#10;&#10;        # Neighbor count statistics&#10;        f.write(f&quot;Neighbor Count Statistics:\n&quot;)&#10;        f.write(f&quot;  - 6Å Sphere: Mean={df['ncps_sphere_6'].mean():.1f}, &quot;&#10;                f&quot;Median={df['ncps_sphere_6'].median():.0f}, &quot;&#10;                f&quot;Range=[{df['ncps_sphere_6'].min():.0f}-{df['ncps_sphere_6'].max():.0f}]\n&quot;)&#10;        f.write(f&quot;  - 10Å Sphere: Mean={df['ncps_sphere_10'].mean():.1f}, &quot;&#10;                f&quot;Median={df['ncps_sphere_10'].median():.0f}, &quot;&#10;                f&quot;Range=[{df['ncps_sphere_10'].min():.0f}-{df['ncps_sphere_10'].max():.0f}]\n\n&quot;)&#10;&#10;        # Uniformity statistics&#10;        f.write(f&quot;Uniformity Statistics:\n&quot;)&#10;        f.write(f&quot;  - 6Å Sphere: Mean={df['ncps_sphere_6_uni'].mean():.2f}, &quot;&#10;                f&quot;Median={df['ncps_sphere_6_uni'].median():.2f}, &quot;&#10;                f&quot;Range=[{df['ncps_sphere_6_uni'].min():.2f}-{df['ncps_sphere_6_uni'].max():.2f}]\n&quot;)&#10;        f.write(f&quot;  - 10Å Sphere: Mean={df['ncps_sphere_10_uni'].mean():.2f}, &quot;&#10;                f&quot;Median={df['ncps_sphere_10_uni'].median():.2f}, &quot;&#10;                f&quot;Range=[{df['ncps_sphere_10_uni'].min():.2f}-{df['ncps_sphere_10_uni'].max():.2f}]\n\n&quot;)&#10;&#10;        f.write(&quot;=&quot; * 120 + &quot;\n\n&quot;)&#10;&#10;        # Main data table&#10;        f.write(&quot;DETAILED RESIDUE DATA\n&quot;)&#10;        f.write(&quot;=&quot; * 120 + &quot;\n\n&quot;)&#10;&#10;        # Column headers&#10;        f.write(f&quot;{'Res':&gt;4} {'ID':&gt;4} {'Num':&gt;5} | {'DSSP':&gt;8} {'DSSP':&gt;6} {'DSSP':&gt;4} | &quot;&#10;                f&quot;{'STRIDE':&gt;8} {'STRIDE':&gt;6} {'STRIDE':&gt;4} | &quot;&#10;                f&quot;{'NC6':&gt;4} {'Uni6':&gt;6} {'NC10':&gt;5} {'Uni10':&gt;6} | {'NCPS':&gt;5}\n&quot;)&#10;        f.write(f&quot;{'#':&gt;4} {'':&gt;4} {'':&gt;5} | {'ASA':&gt;8} {'Class':&gt;6} {'SS':&gt;4} | &quot;&#10;                f&quot;{'ASA':&gt;8} {'Class':&gt;6} {'SS':&gt;4} | &quot;&#10;                f&quot;{'':&gt;4} {'':&gt;6} {'':&gt;5} {'':&gt;6} | {'Class':&gt;5}\n&quot;)&#10;        f.write(&quot;-&quot; * 120 + &quot;\n&quot;)&#10;&#10;        # Data rows&#10;        for idx, row in df.iterrows():&#10;            # Format values&#10;            res_idx = idx + 1&#10;            res_id = row['res_id'][:3] if pd.notna(row['res_id']) else '---'&#10;            res_num = int(row['res_num']) if pd.notna(row['res_num']) else 0&#10;&#10;            dssp_asa = f&quot;{row['dssp_asa']:.1f}&quot; if pd.notna(row['dssp_asa']) else '---'&#10;            dssp_class = f&quot;{int(row['dssp_class'])}&quot; if pd.notna(row['dssp_class']) else '-'&#10;            dssp_ss = row['dssp_ss'] if pd.notna(row['dssp_ss']) and row['dssp_ss'] != '' else '-'&#10;&#10;            stride_asa = f&quot;{row['stride_asa']:.1f}&quot; if pd.notna(row['stride_asa']) else '---'&#10;            stride_class = f&quot;{int(row['stride_class'])}&quot; if pd.notna(row['stride_class']) else '-'&#10;            stride_ss = row['stride_ss'] if pd.notna(row['stride_ss']) and row['stride_ss'] != '' else '-'&#10;&#10;            nc6 = int(row['ncps_sphere_6']) if pd.notna(row['ncps_sphere_6']) else 0&#10;            uni6 = f&quot;{row['ncps_sphere_6_uni']:.3f}&quot; if pd.notna(row['ncps_sphere_6_uni']) else '---'&#10;            nc10 = int(row['ncps_sphere_10']) if pd.notna(row['ncps_sphere_10']) else 0&#10;            uni10 = f&quot;{row['ncps_sphere_10_uni']:.3f}&quot; if pd.notna(row['ncps_sphere_10_uni']) else '---'&#10;&#10;            ncps_class = int(row['ncps_class']) if pd.notna(row['ncps_class']) else 0&#10;&#10;            # Write row&#10;            f.write(f&quot;{res_idx:&gt;4} {res_id:&gt;4} {res_num:&gt;5} | &quot;&#10;                   f&quot;{dssp_asa:&gt;8} {dssp_class:&gt;6} {dssp_ss:&gt;4} | &quot;&#10;                   f&quot;{stride_asa:&gt;8} {stride_class:&gt;6} {stride_ss:&gt;4} | &quot;&#10;                   f&quot;{nc6:&gt;4} {uni6:&gt;6} {nc10:&gt;5} {uni10:&gt;6} | {ncps_class:&gt;5}\n&quot;)&#10;&#10;        f.write(&quot;=&quot; * 120 + &quot;\n\n&quot;)&#10;&#10;        # Legend&#10;        f.write(&quot;LEGEND:\n&quot;)&#10;        f.write(&quot;-&quot; * 120 + &quot;\n&quot;)&#10;        f.write(&quot;Res #     : Sequential residue number\n&quot;)&#10;        f.write(&quot;ID        : Residue amino acid code (ALA, GLN, etc.)\n&quot;)&#10;        f.write(&quot;Num       : Residue number from PDB file\n&quot;)&#10;        f.write(&quot;DSSP ASA  : DSSP accessible surface area (Ų)\n&quot;)&#10;        f.write(&quot;DSSP Class: DSSP classification (1=exterior ≥30Ų, 0=interior &lt;30Ų)\n&quot;)&#10;        f.write(&quot;DSSP SS   : DSSP secondary structure (H=helix, E=strand, C=coil, etc.)\n&quot;)&#10;        f.write(&quot;STRIDE ASA: STRIDE accessible surface area (Ų)\n&quot;)&#10;        f.write(&quot;STRIDE Class: STRIDE classification (1=exterior ≥24Ų, 0=interior &lt;24Ų)\n&quot;)&#10;        f.write(&quot;STRIDE SS : STRIDE secondary structure\n&quot;)&#10;        f.write(&quot;NC6       : Neighbor count within 6Å sphere\n&quot;)&#10;        f.write(&quot;Uni6      : Uniformity at 6Å (spherical variance, 0-1)\n&quot;)&#10;        f.write(&quot;NC10      : Neighbor count within 10Å sphere\n&quot;)&#10;        f.write(&quot;Uni10     : Uniformity at 10Å (spherical variance, 0-1)\n&quot;)&#10;        f.write(&quot;NCPS Class: Our classification (1=exterior, 0=interior)\n\n&quot;)&#10;&#10;        f.write(&quot;CLASSIFICATION PARAMETERS:\n&quot;)&#10;        f.write(&quot;  - nc6_threshold = 6 (minimum neighbors at 6Å)\n&quot;)&#10;        f.write(&quot;  - nc10_threshold = 12 (minimum neighbors at 10Å)\n&quot;)&#10;        f.write(&quot;  - uni6_threshold = 0.30 (minimum uniformity at 6Å)\n&quot;)&#10;        f.write(&quot;  - uni10_threshold = 0.60 (minimum uniformity at 10Å)\n&quot;)&#10;        f.write(&quot;  - Exterior if: NC6 &lt; 6 OR NC10 &lt; 12 OR Uni6 &lt; 0.30 OR Uni10 &lt; 0.60\n&quot;)&#10;        f.write(&quot;  - Interior otherwise\n\n&quot;)&#10;&#10;        f.write(&quot;=&quot; * 120 + &quot;\n\n&quot;)&#10;        &#10;        # ==================== STATISTICS SECTION ====================&#10;        f.write(&quot;STATISTICS\n&quot;)&#10;        f.write(&quot;=&quot; * 120 + &quot;\n\n&quot;)&#10;        &#10;        # DSSP Statistics&#10;        if df['dssp_class'].notna().sum() &gt; 0:&#10;            df_dssp = df[df['dssp_class'].notna()].copy()&#10;            y_true_dssp = df_dssp['dssp_class'].astype(int)&#10;            y_pred_dssp = df_dssp['ncps_class'].astype(int)&#10;            &#10;            f.write(&quot;ACCORDING TO DSSP (Ground Truth = DSSP Classifications):\n&quot;)&#10;            f.write(&quot;=&quot; * 120 + &quot;\n\n&quot;)&#10;            &#10;            # Confusion Matrix&#10;            cm_dssp = confusion_matrix(y_true_dssp, y_pred_dssp)&#10;            tn, fp, fn, tp = cm_dssp.ravel()&#10;            &#10;            f.write(&quot;CONFUSION MATRIX:\n&quot;)&#10;            f.write(&quot;-&quot; * 60 + &quot;\n&quot;)&#10;            f.write(f&quot;{'':20} | {'Predicted Interior (0)':&gt;20} | {'Predicted Exterior (1)':&gt;20} |\n&quot;)&#10;            f.write(&quot;-&quot; * 60 + &quot;\n&quot;)&#10;            f.write(f&quot;{'True Interior (0)':20} | {tn:&gt;20} | {fp:&gt;20} | {tn+fp:&gt;10}\n&quot;)&#10;            f.write(f&quot;{'True Exterior (1)':20} | {fn:&gt;20} | {tp:&gt;20} | {fn+tp:&gt;10}\n&quot;)&#10;            f.write(&quot;-&quot; * 60 + &quot;\n&quot;)&#10;            f.write(f&quot;{'Total':20} | {tn+fn:&gt;20} | {fp+tp:&gt;20} | {tn+fp+fn+tp:&gt;10}\n&quot;)&#10;            f.write(&quot;-&quot; * 60 + &quot;\n\n&quot;)&#10;            &#10;            f.write(&quot;CONFUSION MATRIX INTERPRETATION:\n&quot;)&#10;            f.write(f&quot;  - True Negatives (TN):  {tn:4d} - Correctly predicted as Interior (both DSSP and NCPS agree on Interior)\n&quot;)&#10;            f.write(f&quot;  - False Positives (FP): {fp:4d} - Incorrectly predicted as Exterior (DSSP=Interior, NCPS=Exterior)\n&quot;)&#10;            f.write(f&quot;  - False Negatives (FN): {fn:4d} - Incorrectly predicted as Interior (DSSP=Exterior, NCPS=Interior)\n&quot;)&#10;            f.write(f&quot;  - True Positives (TP):  {tp:4d} - Correctly predicted as Exterior (both DSSP and NCPS agree on Exterior)\n\n&quot;)&#10;            &#10;            # Metrics&#10;            acc_dssp = accuracy_score(y_true_dssp, y_pred_dssp)&#10;            prec_dssp = precision_score(y_true_dssp, y_pred_dssp, average='weighted', zero_division=0)&#10;            rec_dssp = recall_score(y_true_dssp, y_pred_dssp, average='weighted', zero_division=0)&#10;            f1_dssp = f1_score(y_true_dssp, y_pred_dssp, average='weighted', zero_division=0)&#10;            &#10;            # Per-class metrics&#10;            prec_per_class = precision_score(y_true_dssp, y_pred_dssp, average=None, zero_division=0)&#10;            rec_per_class = recall_score(y_true_dssp, y_pred_dssp, average=None, zero_division=0)&#10;            f1_per_class = f1_score(y_true_dssp, y_pred_dssp, average=None, zero_division=0)&#10;            &#10;            f.write(&quot;PERFORMANCE METRICS:\n&quot;)&#10;            f.write(&quot;-&quot; * 60 + &quot;\n&quot;)&#10;            f.write(f&quot;  Overall Accuracy:              {acc_dssp:6.2%} ({int(acc_dssp*len(y_true_dssp))}/{len(y_true_dssp)})\n&quot;)&#10;            f.write(f&quot;  Weighted Precision:            {prec_dssp:6.2%}\n&quot;)&#10;            f.write(f&quot;  Weighted Recall:               {rec_dssp:6.2%}\n&quot;)&#10;            f.write(f&quot;  Weighted F1-Score:             {f1_dssp:6.2%}\n\n&quot;)&#10;            &#10;            f.write(&quot;PER-CLASS METRICS:\n&quot;)&#10;            f.write(f&quot;  Interior (0) - Precision:      {prec_per_class[0]:6.2%}\n&quot;)&#10;            f.write(f&quot;  Interior (0) - Recall:         {rec_per_class[0]:6.2%}\n&quot;)&#10;            f.write(f&quot;  Interior (0) - F1-Score:       {f1_per_class[0]:6.2%}\n\n&quot;)&#10;            f.write(f&quot;  Exterior (1) - Precision:      {prec_per_class[1]:6.2%}\n&quot;)&#10;            f.write(f&quot;  Exterior (1) - Recall:         {rec_per_class[1]:6.2%}\n&quot;)&#10;            f.write(f&quot;  Exterior (1) - F1-Score:       {f1_per_class[1]:6.2%}\n\n&quot;)&#10;            &#10;            f.write(&quot;=&quot; * 120 + &quot;\n\n&quot;)&#10;        &#10;        # STRIDE Statistics&#10;        if df['stride_class'].notna().sum() &gt; 0:&#10;            df_stride = df[df['stride_class'].notna()].copy()&#10;            y_true_stride = df_stride['stride_class'].astype(int)&#10;            y_pred_stride = df_stride['ncps_class'].astype(int)&#10;            &#10;            f.write(&quot;ACCORDING TO STRIDE (Ground Truth = STRIDE Classifications):\n&quot;)&#10;            f.write(&quot;=&quot; * 120 + &quot;\n\n&quot;)&#10;            &#10;            # Confusion Matrix&#10;            cm_stride = confusion_matrix(y_true_stride, y_pred_stride)&#10;            tn, fp, fn, tp = cm_stride.ravel()&#10;            &#10;            f.write(&quot;CONFUSION MATRIX:\n&quot;)&#10;            f.write(&quot;-&quot; * 60 + &quot;\n&quot;)&#10;            f.write(f&quot;{'':20} | {'Predicted Interior (0)':&gt;20} | {'Predicted Exterior (1)':&gt;20} |\n&quot;)&#10;            f.write(&quot;-&quot; * 60 + &quot;\n&quot;)&#10;            f.write(f&quot;{'True Interior (0)':20} | {tn:&gt;20} | {fp:&gt;20} | {tn+fp:&gt;10}\n&quot;)&#10;            f.write(f&quot;{'True Exterior (1)':20} | {fn:&gt;20} | {tp:&gt;20} | {fn+tp:&gt;10}\n&quot;)&#10;            f.write(&quot;-&quot; * 60 + &quot;\n&quot;)&#10;            f.write(f&quot;{'Total':20} | {tn+fn:&gt;20} | {fp+tp:&gt;20} | {tn+fp+fn+tp:&gt;10}\n&quot;)&#10;            f.write(&quot;-&quot; * 60 + &quot;\n\n&quot;)&#10;            &#10;            f.write(&quot;CONFUSION MATRIX INTERPRETATION:\n&quot;)&#10;            f.write(f&quot;  - True Negatives (TN):  {tn:4d} - Correctly predicted as Interior (both STRIDE and NCPS agree on Interior)\n&quot;)&#10;            f.write(f&quot;  - False Positives (FP): {fp:4d} - Incorrectly predicted as Exterior (STRIDE=Interior, NCPS=Exterior)\n&quot;)&#10;            f.write(f&quot;  - False Negatives (FN): {fn:4d} - Incorrectly predicted as Interior (STRIDE=Exterior, NCPS=Interior)\n&quot;)&#10;            f.write(f&quot;  - True Positives (TP):  {tp:4d} - Correctly predicted as Exterior (both STRIDE and NCPS agree on Exterior)\n\n&quot;)&#10;            &#10;            # Metrics&#10;            acc_stride = accuracy_score(y_true_stride, y_pred_stride)&#10;            prec_stride = precision_score(y_true_stride, y_pred_stride, average='weighted', zero_division=0)&#10;            rec_stride = recall_score(y_true_stride, y_pred_stride, average='weighted', zero_division=0)&#10;            f1_stride = f1_score(y_true_stride, y_pred_stride, average='weighted', zero_division=0)&#10;            &#10;            # Per-class metrics&#10;            prec_per_class = precision_score(y_true_stride, y_pred_stride, average=None, zero_division=0)&#10;            rec_per_class = recall_score(y_true_stride, y_pred_stride, average=None, zero_division=0)&#10;            f1_per_class = f1_score(y_true_stride, y_pred_stride, average=None, zero_division=0)&#10;            &#10;            f.write(&quot;PERFORMANCE METRICS:\n&quot;)&#10;            f.write(&quot;-&quot; * 60 + &quot;\n&quot;)&#10;            f.write(f&quot;  Overall Accuracy:              {acc_stride:6.2%} ({int(acc_stride*len(y_true_stride))}/{len(y_true_stride)})\n&quot;)&#10;            f.write(f&quot;  Weighted Precision:            {prec_stride:6.2%}\n&quot;)&#10;            f.write(f&quot;  Weighted Recall:               {rec_stride:6.2%}\n&quot;)&#10;            f.write(f&quot;  Weighted F1-Score:             {f1_stride:6.2%}\n\n&quot;)&#10;            &#10;            f.write(&quot;PER-CLASS METRICS:\n&quot;)&#10;            f.write(f&quot;  Interior (0) - Precision:      {prec_per_class[0]:6.2%}\n&quot;)&#10;            f.write(f&quot;  Interior (0) - Recall:         {rec_per_class[0]:6.2%}\n&quot;)&#10;            f.write(f&quot;  Interior (0) - F1-Score:       {f1_per_class[0]:6.2%}\n\n&quot;)&#10;            f.write(f&quot;  Exterior (1) - Precision:      {prec_per_class[1]:6.2%}\n&quot;)&#10;            f.write(f&quot;  Exterior (1) - Recall:         {rec_per_class[1]:6.2%}\n&quot;)&#10;            f.write(f&quot;  Exterior (1) - F1-Score:       {f1_per_class[1]:6.2%}\n\n&quot;)&#10;            &#10;            f.write(&quot;=&quot; * 120 + &quot;\n\n&quot;)&#10;        &#10;        # ==================== AGREEMENT/DISAGREEMENT LISTS ====================&#10;        &#10;        # DSSP Agreement/Disagreement&#10;        if df['dssp_class'].notna().sum() &gt; 0:&#10;            df_dssp = df[df['dssp_class'].notna()].copy()&#10;            &#10;            # Agreement&#10;            df_agree_dssp = df_dssp[df_dssp['dssp_class'] == df_dssp['ncps_class']].copy()&#10;            f.write(&quot;RESIDUE LIST IN AGREEMENT: NCPS-DSSP\n&quot;)&#10;            f.write(&quot;=&quot; * 120 + &quot;\n&quot;)&#10;            f.write(f&quot;Total: {len(df_agree_dssp)} residues agree\n\n&quot;)&#10;            &#10;            if len(df_agree_dssp) &gt; 0:&#10;                f.write(f&quot;{'Res#':&gt;5} {'ID':&gt;4} {'Num':&gt;5} | {'Class':&gt;6} | {'DSSP ASA':&gt;9} {'NCPS NC6':&gt;9} {'NCPS NC10':&gt;10} {'NCPS Uni6':&gt;10} {'NCPS Uni10':&gt;11}\n&quot;)&#10;                f.write(&quot;-&quot; * 120 + &quot;\n&quot;)&#10;                for idx, row in df_agree_dssp.iterrows():&#10;                    res_idx = df.index.get_loc(idx) + 1&#10;                    class_str = &quot;Interior&quot; if row['dssp_class'] == 0 else &quot;Exterior&quot;&#10;                    f.write(f&quot;{res_idx:&gt;5} {row['res_id']:&gt;4} {int(row['res_num']):&gt;5} | {class_str:&gt;8} | &quot;&#10;                           f&quot;{row['dssp_asa']:&gt;8.1f} {int(row['ncps_sphere_6']):&gt;9} {int(row['ncps_sphere_10']):&gt;10} &quot;&#10;                           f&quot;{row['ncps_sphere_6_uni']:&gt;10.3f} {row['ncps_sphere_10_uni']:&gt;11.3f}\n&quot;)&#10;            f.write(&quot;\n&quot; + &quot;=&quot; * 120 + &quot;\n\n&quot;)&#10;            &#10;            # Disagreement&#10;            df_disagree_dssp = df_dssp[df_dssp['dssp_class'] != df_dssp['ncps_class']].copy()&#10;            f.write(&quot;RESIDUE LIST IN DISAGREEMENT: NCPS-DSSP\n&quot;)&#10;            f.write(&quot;=&quot; * 120 + &quot;\n&quot;)&#10;            f.write(f&quot;Total: {len(df_disagree_dssp)} residues disagree\n\n&quot;)&#10;            &#10;            if len(df_disagree_dssp) &gt; 0:&#10;                f.write(f&quot;{'Res#':&gt;5} {'ID':&gt;4} {'Num':&gt;5} | {'DSSP':&gt;8} {'NCPS':&gt;8} | {'DSSP ASA':&gt;9} {'NCPS NC6':&gt;9} {'NCPS NC10':&gt;10} {'NCPS Uni6':&gt;10} {'NCPS Uni10':&gt;11}\n&quot;)&#10;                f.write(&quot;-&quot; * 120 + &quot;\n&quot;)&#10;                for idx, row in df_disagree_dssp.iterrows():&#10;                    res_idx = df.index.get_loc(idx) + 1&#10;                    dssp_str = &quot;Interior&quot; if row['dssp_class'] == 0 else &quot;Exterior&quot;&#10;                    ncps_str = &quot;Interior&quot; if row['ncps_class'] == 0 else &quot;Exterior&quot;&#10;                    f.write(f&quot;{res_idx:&gt;5} {row['res_id']:&gt;4} {int(row['res_num']):&gt;5} | {dssp_str:&gt;8} {ncps_str:&gt;8} | &quot;&#10;                           f&quot;{row['dssp_asa']:&gt;8.1f} {int(row['ncps_sphere_6']):&gt;9} {int(row['ncps_sphere_10']):&gt;10} &quot;&#10;                           f&quot;{row['ncps_sphere_6_uni']:&gt;10.3f} {row['ncps_sphere_10_uni']:&gt;11.3f}\n&quot;)&#10;            f.write(&quot;\n&quot; + &quot;=&quot; * 120 + &quot;\n\n&quot;)&#10;        &#10;        # STRIDE Agreement/Disagreement&#10;        if df['stride_class'].notna().sum() &gt; 0:&#10;            df_stride = df[df['stride_class'].notna()].copy()&#10;            &#10;            # Agreement&#10;            df_agree_stride = df_stride[df_stride['stride_class'] == df_stride['ncps_class']].copy()&#10;            f.write(&quot;RESIDUE LIST IN AGREEMENT: NCPS-STRIDE\n&quot;)&#10;            f.write(&quot;=&quot; * 120 + &quot;\n&quot;)&#10;            f.write(f&quot;Total: {len(df_agree_stride)} residues agree\n\n&quot;)&#10;            &#10;            if len(df_agree_stride) &gt; 0:&#10;                f.write(f&quot;{'Res#':&gt;5} {'ID':&gt;4} {'Num':&gt;5} | {'Class':&gt;6} | {'STRIDE ASA':&gt;11} {'NCPS NC6':&gt;9} {'NCPS NC10':&gt;10} {'NCPS Uni6':&gt;10} {'NCPS Uni10':&gt;11}\n&quot;)&#10;                f.write(&quot;-&quot; * 120 + &quot;\n&quot;)&#10;                for idx, row in df_agree_stride.iterrows():&#10;                    res_idx = df.index.get_loc(idx) + 1&#10;                    class_str = &quot;Interior&quot; if row['stride_class'] == 0 else &quot;Exterior&quot;&#10;                    f.write(f&quot;{res_idx:&gt;5} {row['res_id']:&gt;4} {int(row['res_num']):&gt;5} | {class_str:&gt;8} | &quot;&#10;                           f&quot;{row['stride_asa']:&gt;10.1f} {int(row['ncps_sphere_6']):&gt;9} {int(row['ncps_sphere_10']):&gt;10} &quot;&#10;                           f&quot;{row['ncps_sphere_6_uni']:&gt;10.3f} {row['ncps_sphere_10_uni']:&gt;11.3f}\n&quot;)&#10;            f.write(&quot;\n&quot; + &quot;=&quot; * 120 + &quot;\n\n&quot;)&#10;            &#10;            # Disagreement&#10;            df_disagree_stride = df_stride[df_stride['stride_class'] != df_stride['ncps_class']].copy()&#10;            f.write(&quot;RESIDUE LIST IN DISAGREEMENT: NCPS-STRIDE\n&quot;)&#10;            f.write(&quot;=&quot; * 120 + &quot;\n&quot;)&#10;            f.write(f&quot;Total: {len(df_disagree_stride)} residues disagree\n\n&quot;)&#10;            &#10;            if len(df_disagree_stride) &gt; 0:&#10;                f.write(f&quot;{'Res#':&gt;5} {'ID':&gt;4} {'Num':&gt;5} | {'STRIDE':&gt;8} {'NCPS':&gt;8} | {'STRIDE ASA':&gt;11} {'NCPS NC6':&gt;9} {'NCPS NC10':&gt;10} {'NCPS Uni6':&gt;10} {'NCPS Uni10':&gt;11}\n&quot;)&#10;                f.write(&quot;-&quot; * 120 + &quot;\n&quot;)&#10;                for idx, row in df_disagree_stride.iterrows():&#10;                    res_idx = df.index.get_loc(idx) + 1&#10;                    stride_str = &quot;Interior&quot; if row['stride_class'] == 0 else &quot;Exterior&quot;&#10;                    ncps_str = &quot;Interior&quot; if row['ncps_class'] == 0 else &quot;Exterior&quot;&#10;                    f.write(f&quot;{res_idx:&gt;5} {row['res_id']:&gt;4} {int(row['res_num']):&gt;5} | {stride_str:&gt;8} {ncps_str:&gt;8} | &quot;&#10;                           f&quot;{row['stride_asa']:&gt;10.1f} {int(row['ncps_sphere_6']):&gt;9} {int(row['ncps_sphere_10']):&gt;10} &quot;&#10;                           f&quot;{row['ncps_sphere_6_uni']:&gt;10.3f} {row['ncps_sphere_10_uni']:&gt;11.3f}\n&quot;)&#10;            f.write(&quot;\n&quot; + &quot;=&quot; * 120 + &quot;\n\n&quot;)&#10;&#10;        f.write(&quot;=&quot; * 120 + &quot;\n&quot;)&#10;&#10;    return output_file&#10;&#10;def main():&#10;    &quot;&quot;&quot;Generate detailed reports for all proteins.&quot;&quot;&quot;&#10;&#10;    pdb_ids = ['3PTE', '4d05', '6wti', '7upo']&#10;&#10;    print(&quot;=&quot; * 80)&#10;    print(&quot;GENERATING DETAILED REPORTS FOR ALL PROTEINS&quot;)&#10;    print(&quot;=&quot; * 80)&#10;    print()&#10;&#10;    generated_files = []&#10;&#10;    for pdb_id in pdb_ids:&#10;        print(f&quot;Processing {pdb_id}...&quot;)&#10;        output_file = generate_detailed_report(pdb_id)&#10;&#10;        if output_file:&#10;            print(f&quot;  ✅ Generated: {output_file}&quot;)&#10;            generated_files.append(output_file)&#10;        else:&#10;            print(f&quot;  ❌ Failed to generate report&quot;)&#10;&#10;    print()&#10;    print(&quot;=&quot; * 80)&#10;    print(f&quot;✅ COMPLETE! Generated {len(generated_files)} detailed reports&quot;)&#10;    print(&quot;=&quot; * 80)&#10;    print()&#10;    print(&quot;Output files:&quot;)&#10;    for f in generated_files:&#10;        print(f&quot;  - {f}&quot;)&#10;    print()&#10;&#10;if __name__ == &quot;__main__&quot;:&#10;    main()&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>